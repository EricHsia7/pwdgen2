<!DOCTYPE html>
<html lang="en">

<head>
 <meta charset="UTF-8">
 <title>Password Generator</title>
 <meta name="description" content="Password Generator - Generate strong passwords">
 <meta name="viewport" content="width=device-width, initial-scale=1.0,user-scalable=0" />
 <link href="https://erichsia7.github.io/pwdgen2/pwaicon8/512x512.png" sizes="512x512" rel="apple-touch-icon" />
 <meta name="apple-mobile-web-app-capable" content="yes" />
 <meta name="apple-mobile-web-app-status-bar-style" content="defualt" />
 <link type="image/x-icon" href="https://erichsia7.github.io/pwdgen2/pwaicon8/256x256_corner_radius.ico" rel="icon" />
 <link type="image/x-icon" href="https://erichsia7.github.io/pwdgen2/pwaicon8/256x256_corner_radius.ico" rel="bookmark" />
 <link type="image/x-icon" href="https://erichsia7.github.io/pwdgen2/pwaicon8/256x256_corner_radius.ico" rel="shortcut icon" />
 <meta name="theme-color" media="(prefers-color-scheme: light)" content="#f2f2f7" kji="light">
 <meta name="theme-color" media="(prefers-color-scheme: dark)" content="#0a0a0b" kji="dark">
 <link rel="manifest" href="https://erichsia7.github.io/pwdgen2/manifest7.json?e1">
 <style>
  * {
   -webkit-appearance: none;
   appearance: none;
   outline: none;
   -webkit-tap-highlight-color: rgba(0, 0, 0, 0);
   font-family: 'Noto Sans', sans-serif;
  }

  :root {
   --p-main-color: #54b4e4;
   --p-f2f2f7: #f2f2f7;
   --p-ffffff: #ffffff;
   --p-e5e5ea: #e5e5ea;
   --p-aeaeb2: #aeaeb2;
   --p-333333: #333333;
  }

  @media (prefers-color-scheme: dark) {
   :root {
    --p-f2f2f7: #0a0a0b;
    --p-ffffff: #1c1c1e;
    --p-e5e5ea: #2c2c2e;
    --p-aeaeb2: #636366;
    --p-333333: #ffffff;
   }
  }

  svg path {
   fill: var(--p-333333);
  }

  body {
   padding: 0px;
   margin: 0px;
   background: var(--p-f2f2f7);
   overflow: hidden;
  }

  .container {
   position: fixed;
   top: 0px;
   left: 0px;
   width: 100%;
   height: 100%;
   overflow: scroll;
   -webkit-overflow-scrolling: touch;
   overscroll-behavior: contain;
  }

  .title-box {
   position: relative;
   width: 100%;
   height: 90px;
  }

  .title {
   font-size: 2.5rem;
   font-weight: 700;
   display: inline-block;
   position: absolute;
   left: 15px;
   bottom: 0px;
   line-height: 2.5rem;
   transform-origin: left bottom;
   transform: scale(var(--scroll-scale));
   color: var(--p-333333)
  }

  .fixed-title-box {
   position: fixed;
   left: 0px;
   top: 0px;
   width: 100%;
   height: 50px;
   background: var(--p-f2f2f7);
   font-size: 20px;
   font-weight: 700;
   display: flex;
   justify-content: center;
   align-items: center;
   color: rgba(0, 0, 0, 0);
   transition: color 0.3s;
  }

  .fixed-title-box[sticky="true"] {
   color: var(--p-333333);
   background: var(--p-ffffff)
  }

  .search-box {
   height: 60px;
   width: 100%;
   position: relative;
   background: var(--p-f2f2f7);
   transition: transform 0.3s;
  }

  .search-box[status="1"] {
   transform: translateY(-40px);
   background: var(--p-ffffff);
  }

  .search-box[sticky="true"] {
   position: fixed;
   top: 40px;
   left: 0px;
   background: var(--p-ffffff);
   border-bottom: var(--p-e5e5ea) 1px solid
  }

  .search-cancel {
   position: absolute;
   top: 10px;
   right: 15px;
   width: 55px;
   height: 40px;
   opacity: 0;
   justify-content: center;
   align-items: center;
   font-size: 16px;
   transition: 0.3s;
   display: flex;
   color: var(--p-main-color);
   font-weight: 500;
  }

  .search-box[status="1"] .search-cancel {
   opacity: 1;
  }

  .search {
   position: absolute;
   top: 10px;
   left: 15px;
   width: calc(100% - 30px);
   height: 40px;
   background: var(--p-e5e5ea);
   border-radius: 10px;
   transition: width 0.3s
  }

  .search-box[sticky="true"] .search {
   background: var(--p-f2f2f7);
  }

  .search-box[status="1"] .search {
   width: calc(100% - 95px);
  }

  .search input#search {
   position: absolute;
   top: 5px;
   left: 40px;
   padding: 0px;
   margin: 0px;
   border-radius: 0px;
   border: none;
   width: calc(100% - 45px);
   height: calc(100% - 10px);
   font-size: 18px;
   background: rgba(0, 0, 0, 0);
   caret-color: var(--p-main-color);
   color: var(--p-333333);
  }

  .search input#search::placeholder {
   color: var(--p-aeaeb2);
   opacity: 1;
  }

  .search-icon {
   width: 40px;
   height: 40px;
   position: absolute;
   top: 0px;
   left: 0px;
   display: flex;
   justify-content: center;
   align-items: center;
  }

  .search-icon svg {
   width: 23px;
   height: 23px;
  }

  .search-icon svg path {
   fill: var(--p-aeaeb2);
  }

  .contents-box {
   display: inline-block;
   min-height: 120vh;
   width: 100%;
  }

  .password-list {
   position: relative;
   width: 100%;
   display: inline-block;
   border-radius: 10px;
   overflow: hidden;
   background: var(--p-ffffff);
  }

  .password-item {
   position: relative;
   width: calc(100% - 20px);
   height: 80px;

   border-bottom: var(--p-e5e5ea) 1px solid;
   left: 10px;
   box-sizing: border-box;
  }

  .password-item .password-item-title {
   position: absolute;
   top: 10px;
   left: 0px;
   width: calc(100% - 30px);
   height: 30px;
   font-size: 20px;
   font-weight: 500;
   display: flex;
   align-items: center;
   color: var(--p-333333)
  }

  .password-item .password-item-tags {
   position: absolute;
   left: 0px;
   top: 40px;
   width: calc(100% - 30px);
   height: 35px;
   display: flex;
   overflow: hidden;
   flex-direction: row;
  }

  .password-item .password-item-tags li {
   list-style: none;
   display: inline-block;
   height: 35px;
   color: var(--p-main-color);
   font-size: 20px;
   align-items: center;
   padding: 0px;
   margin: 0px;
   margin-right: 5px;
  }

  .password-item .password-open-icon {
   width: 25px;
   height: 80px;
   top: 0px;
   right: 0px;
   position: absolute;
   display: flex;
   justify-content: center;
   align-items: center;
  }

  .password-item .password-open-icon svg {
   width: 20px;
   height: 20px;
  }

  .password-item .password-open-icon svg path {
   fill: var(--p-aeaeb2);
  }

  .password-item .password-item-tags li:before {
   content: '#';
  }

  .password-list .password-item:last-child {
   border: none;
  }

  .contents-box {
   position: absolute;
   top: 155px;
   left: 15px;
   width: calc(100% - 30px);
  }
 </style>
</head>

<body>

 <div class="container" p="main-page">
  <div class="contents-box">
   <div class="password-list"></div>
  </div>
  <div class="title-box">
   <div class="title">Passwords</div>
  </div>
  <div class="fixed-title-box">Passwords</div>
  <div class="search-box">
   <div class="search-cancel" onclick="closeSearch()">
    Cancel
   </div>
   <div class="search">
    <div class="search-icon">
     <svg stroke-miterlimit="10" style="fill-rule:nonzero;clip-rule:evenodd;stroke-linecap:round;stroke-linejoin:round;" version="1.1" viewBox="0 0 64 64" xml:space="preserve" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
      <path d="M60.0889 64L36.7111 40.6222C34.9333 42.163 32.8605 43.363 30.4925 44.2222C28.1246 45.0815 25.6049 45.5111 22.9333 45.5111C16.5237 45.5111 11.0991 43.2889 6.65947 38.8444C2.21982 34.4 0 29.037 0 22.7556C0 16.4741 2.22222 11.1111 6.66667 6.66667C11.1111 2.22222 16.4889 0 22.8 0C29.1111 0 34.4741 2.22222 38.8889 6.66667C43.3037 11.1111 45.5111 16.4785 45.5111 22.7689C45.5111 25.3081 45.0963 27.763 44.2667 30.1333C43.437 32.5037 42.1926 34.7259 40.5333 36.8L64 60.0889L60.0889 64ZM22.8444 40.1778C27.6593 40.1778 31.7519 38.4741 35.1222 35.0667C38.4926 31.6593 40.1778 27.5556 40.1778 22.7556C40.1778 17.9556 38.4926 13.8519 35.1222 10.4444C31.7519 7.03704 27.6593 5.33333 22.8444 5.33333C17.9803 5.33333 13.8457 7.03704 10.4407 10.4444C7.03579 13.8519 5.33333 17.9556 5.33333 22.7556C5.33333 27.5556 7.03579 31.6593 10.4407 35.0667C13.8457 38.4741 17.9803 40.1778 22.8444 40.1778Z" fill-rule="nonzero" opacity="1" stroke="none" />
     </svg>
    </div>
    <input type="text" placeholder="Search" id="search">
   </div>
  </div>
 </div>
 <div class="container" p="password-page">
  <div class="fixed-title-box">Password</div>
 </div>
</body>
<script src="https://cdnjs.cloudflare.com/ajax/libs/lodash.js/4.17.21/lodash.min.js" integrity="sha512-WFN04846sdKMIP5LKNphMaWzU7YpMyCU245etK3g/2ARYbPK9Ub18eG+ljU96qKRCWh+quCY7yefSmlkQw1ANQ==" crossorigin="anonymous" referrerpolicy="no-referrer"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/aes-js/3.1.2/index.min.js" integrity="sha512-LOqfKFwH2W3jeb0NzXcImFlSyoL7hjsWbZvIeKNOaZw1gFw+yKTE/QUDGLit2KWdd57qd6IgMDkppK2tkwIEhA==" crossorigin="anonymous" referrerpolicy="no-referrer"></script>
<script>

 let LS = window.localStorage
 let icon_arrow = `<svg stroke-miterlimit="10" style="fill-rule:nonzero;clip-rule:evenodd;stroke-linecap:round;stroke-linejoin:round;" version="1.1" viewBox="0 0 64 64" xml:space="preserve" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"><path d="M18.24 64L13.76 59.44L41.2 32L13.76 4.56L18.24 0L50.24 32L18.24 64Z" fill-rule="nonzero" opacity="1" stroke="none" /></svg>`
 function encryptString(string) {
  var initialization_vector_pattern = [
   {
    type: "regex",
    regex: "/[1-9]/g",
    quantity: 1,
    repeat: false
   },
   {
    type: "group",
    group: [
     {
      type: "regex",
      regex: "/[0-9]/g",
      quantity: 9,
      repeat: true
     }
    ],
    actions: [
     "shuffle"
    ]
   }
  ]
  var initialization_vector = parseInt(pwd_fine_grained_pattern(initialization_vector_pattern));
  var keyu = [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31];
  var textBytes = aesjs.utils.utf8.toBytes(string);
  var aesCtr = new aesjs.ModeOfOperation.ctr(keyu, new aesjs.Counter(initialization_vector));
  var encryptedBytes = aesCtr.encrypt(textBytes);
  var encryptedHex = aesjs.utils.hex.fromBytes(encryptedBytes);
  return [encryptedHex, initialization_vector]
 }

 function decryptString(encrypted_string, initialization_vector) {
  var keye = [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31];
  var encryptedBytese = aesjs.utils.hex.toBytes(encrypted_string);
  var aesCtre = new aesjs.ModeOfOperation.ctr(keye, new aesjs.Counter(parseInt(initialization_vector)));
  var decryptedBytese = aesCtre.decrypt(encryptedBytese);
  var decryptedText = aesjs.utils.utf8.fromBytes(decryptedBytese);
  return decryptedText;
 }
 function enur(u) {
  return encodeURIComponent(u)
 }
 function deur(u) {
  return decodeURIComponent(u)
 }

 function gid(n) {
  var genidchars = "0123456789abcdefghijklmnopqrstuvwxyz";
  var genid = "";
  for (var i = 0; i < 16; i++) {
   var genrandomNumber = Math.floor(Math.random() * genidchars.length);
   genid += genidchars.substring(genrandomNumber, genrandomNumber + 1);
  }
  if (!(n === undefined)) {
   n = n.replaceAll('_', '-')
   return n + '-' + genid + '' + new Date().getTime();
  }
  return genid + '' + new Date().getTime();
 }
 function shuffleSelf(array, size) {
  var index = -1,
   length = array.length,
   lastIndex = length - 1;
  size = size === undefined ? length : size;
  while (++index < size) {
   var rand = index + Math.floor(Math.random() * (lastIndex - index + 1))
   value = array[rand];
   array[rand] = array[index];
   array[index] = value;
  }
  array.length = size;
  return array;
 }

 function pwd_fine_grained_pattern(options) {
  var pattern = _.cloneDeep(options);
  var d = ""
  var get_chars_from_regex = function (regex) {
   var input = String.fromCharCode(...Array.from({ length: Math.pow(2, 16) }, (_, i) => i));
   var matches = String(input).match(regex);
   var chars = matches ? matches.join('') : '';
   return chars
  }
  var pattern_len = pattern.length
  for (var e = 0; e < pattern_len; e++) {
   var this_item = pattern[e]
   var this_content = this_item[this_item['type']]

   var result = ''
   if (this_item['type'] === "regex") {
    var this_content_matches = this_content.match(/^\/(.*)\/([a-z]*)$/i);
    var string = ''
    var chars = get_chars_from_regex(new RegExp(this_content_matches[1], this_content_matches[2])).split('')
    for (var r = 0; r < this_item['quantity']; r++) {
     var random_index = Math.round((chars.length - 1) * Math.random())
     string += chars[random_index]
     if (!this_item.repeat) {
      chars.splice(random_index, 1)
     }
    }
    result = String(string)
   }
   if (this_item['type'] === "string") {
    result = String(this_content)
   }
   if (this_item['type'] === "list") {
    for (var r = 0; r < this_item['quantity']; r++) {
     var random_index = Math.round((this_content.length - 1) * Math.random())
     result += this_content[random_index]
     if (!this_item.repeat) {
      this_content.splice(random_index, 1)
     }
    }
   }
   if (this_item['type'] === "group") {
    result = pwd_fine_grained_pattern(this_content)
    var actions = this_item['actions']
    var actions_len = actions.length
    for (var j = 0; j < actions_len; j++) {
     if (actions[j] === 'shuffle') {
      result = shuffleSelf(result.split(''), result.length).join('')
      continue;
     }
    }
   }
   d += result
  }
  return d
 }

 function che(y) {
  if (y < 10) {
   return '0' + y
  }
  else {
   return y
  }
 }
 function timestr(date) {
  return date.getFullYear() + '-' + che(date.getMonth() + 1) + '-' + che(date.getDate()) + ' ' + che(date.getHours()) + ':' + che(date.getMinutes()) + ':' + che(date.getSeconds())
 }
 function searchItemsbyname(name) {
  var gh = []
  for (var t in window.localStorage) {
   if (String(t).indexOf(name) > -1) {
    gh.push(t)
   }
  }
  return gh
 }
 function listSavedPassword() {
  var list = searchItemsbyname('pwdgen2_saved_b')
  var list_len = list.length
  var list_decrypted = []
  for (var k = 0; k < list_len; k++) {
   var this_item = JSON.parse(String(LS.getItem(list[k])))
   list_decrypted.push({ website: this_item.website, password: deur(decryptString(this_item.encrypted_password, this_item.aes_iv)), note: this_item.note, time_stamp: this_item.time_stamp, id: this_item.id })
  }
  list_decrypted.sort(function (a, b) {
   return new Date(b.time_stamp).getTime() - new Date(a.time_stamp).getTime()
  })

  return list_decrypted
 }
 function printSavedPasswordList() {
  var list = listSavedPassword()
  var list_len = list.length
  var html = []
  for (var k = 0; k < list_len; k++) {
   var tags = []
   html.push(`<div class="password-item" onclick="openPassword('${list[k].id}')"><div class="password-item-title">${timestr(new Date(list[k].time_stamp))}</div><div class="password-item-tags">${tags}</div><div class="password-open-icon">${icon_arrow}</div></div>`)

  }
  qe(".password-list").innerHTML = html.join('')
 }

 function upgradeData() {
  var id_pattern = [
   {
    type: "group",
    group: [
     {
      type: "regex",
      regex: "/[A-Za-z0-9]/g",
      quantity: 32,
      repeat: true
     }
    ],
    actions: ["shuffle"]
   }
  ]
  var list = searchItemsbyname('pwdgen2_saved_a')
  if (list.length <= 0) {
   return ''
  }
  var list_len = list.length
  var list_decrypted = []
  for (var k = 0; k < list_len; k++) {
   var this_item = String(localStorage.getItem(list[k])).split(':')

   var pwtime = new Date()
   pwtime.setTime(this_item[2])
   var id = pwd_fine_grained_pattern(id_pattern)
   list_decrypted.push({ website: "", encrypted_password: this_item[0], aes_iv: parseInt(this_item[1]), note: "", time_stamp: pwtime, id: id })
   LS.setItem(`pwdgen2_saved_b_${id}`, JSON.stringify(list_decrypted[list_decrypted.length - 1]))
   LS.removeItem(list[k])
  }
 }

 function qe(selector) {
  return document.querySelector(selector)
 }
 var search_sticky = false
 var container_scrollTop = 0
 qe('.container[p="main-page"]').addEventListener('scroll', function (e) {
  container_scrollTop = qe('.container[p="main-page"]').scrollTop
  var scale = 1
  if (container_scrollTop < 0) {
   scale = 1 + (Math.abs(container_scrollTop) / 500)
   if (scale > 1.3) {
    scale = 1.3
   }
  }
  qe('.container[p="main-page"] .title').style.setProperty('--scroll-scale', scale)
  if (container_scrollTop >= 50) {
   qe('.container[p="main-page"] .search-box').setAttribute('sticky', 'true')
   qe('.container[p="main-page"] .fixed-title-box').setAttribute('sticky', 'true')
   search_sticky = true
  }
  else {
   qe('.container[p="main-page"] .search-box').setAttribute('sticky', 'false')
   qe('.container[p="main-page"] .fixed-title-box').setAttribute('sticky', 'false')
   search_sticky = false
  }
 })

 function openSearch() {
  qe(".search-box").setAttribute('status', '1')
  qe(".search-box").setAttribute('sticky', 'true')


 }
 function closeSearch() {
  qe(".search-box").setAttribute('status', '0')
  qe(".search-box").setAttribute('sticky', search_sticky)

 }

 qe(".search").addEventListener("click", function (e) {
  openSearch()
 })
 qe(".search-box .search input#search").addEventListener("focus", function (e) {
  openSearch()
 })

 upgradeData()
 printSavedPasswordList()
</script>

</html>